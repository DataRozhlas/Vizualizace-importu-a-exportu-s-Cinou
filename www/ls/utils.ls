ig.utils = utils = {}
ig.existing =
  export: <[1 11 111 1110 112 1121 1122 1123 1124 12 122 1222 2 21 211 2112 2119 212 2122 22 222 2221 2222 2224 223 2237 23 231 2311 2312 232 2321 2322 24 244 2440 247 2474 2475 2479 248 2482 2483 2484 2485 25 251 2511 2513 2515 2516 2519 26 263 2631 2634 266 2665 2666 2667 267 2671 2672 268 2681 2686 2687 269 2690 27 272 2721 2723 273 2731 2732 2733 2734 277 2772 278 2782 2783 2785 2789 28 282 2822 2823 285 2852 287 2878 288 2882 29 291 2911 2919 292 2922 2924 2925 2926 2929 3 32 322 3222 33 334 3346 335 3351 3352 3354 34 344 4 41 411 4113 42 421 4217 43 431 4312 5 51 511 5111 5112 5113 5114 512 5121 5122 5123 5124 513 5137 5138 5139 514 5145 5146 5147 5148 515 5154 5155 5156 5157 516 5161 5162 5163 5169 52 522 5221 5222 5223 5225 5226 523 5231 5232 5233 5234 5235 5236 5237 5238 524 5243 5249 525 5251 5259 53 531 5311 5312 532 5322 533 5331 5332 5334 5335 54 541 5411 5413 5414 5415 5416 5419 542 5421 5422 5423 5429 55 551 5513 5514 553 5531 5532 5533 5534 5535 554 5541 5542 5543 56 562 5621 5623 5629 57 571 5711 5712 5719 572 5721 5729 573 5731 5739 574 5741 5742 5743 575 5751 5752 5753 5754 5755 5759 579 5791 5792 5793 5799 58 581 5811 5812 5813 5814 5815 5816 5817 582 5821 5822 5829 583 5831 5832 5839 59 591 5911 5914 5919 592 5921 5922 593 5931 5932 597 5972 5973 5977 598 5981 5983 5985 5986 5988 5989 599 5991 5994 6 61 611 6112 6114 6115 6117 612 6122 6129 613 6131 6132 6133 62 621 6211 6212 6213 6214 625 6251 6252 6253 6254 6255 6259 629 6291 6292 6299 63 633 6331 6332 634 6341 6342 6343 6345 6349 635 6351 6352 6353 6354 6359 64 641 6411 6412 6413 6414 6415 6416 6417 6419 642 6421 6422 6423 6424 6429 65 651 6511 6512 6513 6514 6515 6516 6517 6518 6519 652 6521 6522 6523 6524 6525 6526 6529 653 6531 6532 6533 6534 6535 6536 6538 6539 654 6542 6543 6544 6546 6549 655 6551 6552 656 6561 6562 6563 6564 6565 657 6571 6572 6573 6575 6576 6577 6578 6579 658 6581 6582 6583 6584 6585 6589 659 6591 6594 6595 6596 66 661 6611 6613 6618 662 6623 6624 663 6631 6632 6633 6635 6637 6638 6639 664 6641 6643 6644 6645 6647 6648 6649 665 6651 6652 6659 666 6661 6662 667 6671 6672 6673 6674 67 671 6713 6714 6715 672 6724 6726 6727 6728 673 6732 6734 6735 674 6741 6742 6743 6744 6745 675 6751 6752 6753 6754 6755 6756 6757 676 6761 6762 6763 6764 6768 677 6770 678 6781 6782 679 6791 6793 6794 6795 68 681 6811 6812 682 6821 6823 6824 6825 6826 6827 683 6832 684 6841 6842 685 6852 687 6872 689 6891 6899 69 691 6911 6912 692 6921 6924 693 6931 6932 6935 694 6941 6942 6943 6944 695 6951 6952 6953 6954 6955 6956 6957 696 6963 6964 6965 6966 6968 697 6973 6974 6975 6978 699 6991 6992 6993 6994 6995 6996 6997 6998 6999 7 71 711 7111 7112 7119 712 7121 7128 713 7131 7132 7138 7139 714 7144 7148 7149 716 7161 7162 7163 7164 7165 7169 718 7181 7187 7189 72 721 7211 7212 7213 7219 722 7223 7224 723 7232 7233 7234 7239 724 7243 7244 7245 7246 7247 7248 7249 725 7251 7252 7259 726 7263 7265 7266 7268 7269 727 7271 7272 728 7281 7282 7283 7284 7285 73 731 7311 7312 7313 7314 7315 7316 7317 733 7331 7339 735 7351 7359 737 7371 7372 7373 7374 74 741 7412 7413 7414 7415 7417 7418 7419 742 7421 7422 7423 7424 7425 7426 7427 7429 743 7431 7434 7435 7436 7438 7439 744 7441 7442 7443 7444 7447 7448 7449 745 7451 7452 7453 7456 7459 746 7461 7462 7463 7464 7465 7468 7469 747 7471 7472 7473 7474 7478 7479 748 7481 7482 7483 7484 7485 7486 7489 749 7491 7492 7499 75 751 7511 7512 7519 752 7522 7523 7526 7527 7528 7529 759 7598 7599 76 761 7613 7614 7615 7616 762 7621 7622 7628 763 7633 7638 764 7641 7642 7643 7648 7649 77 771 7711 7712 772 7722 7723 7724 7725 7726 7728 773 7731 7732 774 7741 7742 775 7751 7752 7753 7754 7755 7757 7758 776 7761 7762 7763 7764 7768 778 7781 7782 7783 7784 7786 7787 7788 78 781 7811 7812 782 7821 7822 784 7841 7842 7843 785 7851 7852 7853 786 7862 7863 7868 79 791 7911 7912 7917 7919 792 7921 7922 7923 7928 7929 793 7931 7932 7939 8 81 811 812 8121 8122 813 8131 8132 8138 8139 82 821 8211 8212 8213 8215 8217 8218 83 831 8311 8312 8313 8319 84 841 8411 8412 8413 8414 8415 8416 842 8421 8422 8423 8424 8425 8426 8427 8428 843 8431 8432 8437 8438 844 8441 8442 8447 8448 845 8451 8452 8453 8454 8455 8456 8458 8459 846 8461 8462 8469 848 8481 8482 8483 8484 85 851 8511 8512 8513 8514 8515 8517 8519 87 871 8711 8713 8714 8719 872 8721 8722 8723 8724 873 8731 8732 874 8741 8742 8743 8744 8745 8746 8747 8749 88 881 8811 8812 8813 882 8821 8822 8823 8824 8825 8826 884 8841 8842 8843 885 8853 8854 8857 8859 89 891 8911 8912 8913 8919 892 8921 8922 8924 8928 893 8931 8932 8933 8939 894 8941 8942 8943 8944 8947 895 8951 8952 8959 896 8961 8963 8964 8965 8966 897 8972 8973 8974 898 8981 8982 8984 8989 899 8991 8992 8993 8994 8996 8997 8998 8999 9 93 931 96 961 97 971 9710 972]>
  exportAssoc: {}
  import: <[0 00 001 0015 0019 01 011 0111 0112 012 0122 0123 0129 016 0161 0168 017 0172 0173 0174 0175 02 022 0221 0222 0223 0224 023 024 0243 0249 025 0251 0252 0253 03 034 0341 0342 0344 0345 035 0351 0352 0353 0354 036 0361 0362 0363 037 0371 0372 04 041 0411 042 0421 0422 0423 043 044 0449 045 0453 0459 046 0461 0462 047 0471 0472 048 0481 0482 0483 0484 0485 05 054 0541 0542 0544 0545 0546 0547 0548 056 0561 0564 0566 0567 057 0571 0572 0573 0574 0575 0576 0577 0579 058 0581 0582 0583 0589 059 0591 0592 0599 06 061 0611 0612 0615 0616 0619 062 0621 0622 07 071 0711 0712 0713 072 0722 073 0731 0732 0733 0739 074 0741 0743 075 0751 0752 08 081 0811 0812 0813 0814 0815 0819 09 091 0910 098 0981 0984 0985 0986 0989 1 11 111 1110 112 1121 1122 1123 1124 12 121 1211 1212 1213 122 1221 1222 1223 2 21 211 2112 2116 2119 212 2122 22 222 2221 2222 2224 2225 2226 223 2234 2237 2239 23 231 2311 2312 2313 232 2321 2322 24 244 2440 245 2450 246 2461 2462 247 2473 2474 2475 2479 248 2482 2483 2484 2485 25 251 2511 2512 2515 2516 2519 26 261 2613 2614 263 2631 2632 2633 2634 264 2641 2649 265 2651 2652 2658 266 2665 2666 2667 267 2671 2672 268 2681 2682 2683 2685 2686 2687 269 2690 27 272 2721 2723 273 2731 2732 2733 2734 274 2741 2742 277 2771 2772 278 2782 2783 2785 2786 2789 28 281 2815 282 2823 285 2851 2852 287 2877 2878 2879 288 2881 2882 289 2891 2892 29 291 2911 2919 292 2922 2923 2924 2925 2926 2927 2929 3 32 321 3211 3212 322 3221 3223 325 33 334 3346 3347 335 3351 3352 3353 3354 34 342 3421 3425 344 3442 3449 35 351 4 41 411 4111 4112 4113 42 421 4212 4213 4214 4215 4217 4218 422 4222 4223 4225 4229 43 431 4311 4312 4313 4314 5 51 511 5111 5112 5113 5114 512 5121 5122 5123 5124 513 5137 5138 5139 514 5145 5146 5147 5148 515 5154 5155 5156 5157 5158 516 5161 5162 5163 5169 52 522 5221 5222 5223 5224 5225 5226 523 5231 5232 5233 5234 5235 5236 5237 5238 524 5243 5249 525 5251 5259 53 531 5311 5312 532 5322 5323 533 5331 5332 5334 5335 54 541 5411 5413 5414 5415 5416 5419 542 5421 5422 5423 5429 55 551 5513 5514 553 5531 5532 5533 5534 5535 554 5541 5542 5543 56 562 5621 5622 5623 5629 57 571 5711 5712 5719 572 5721 5729 573 5731 5739 574 5741 5742 5743 575 5751 5752 5753 5754 5755 5759 579 5791 5792 5793 5799 58 581 5811 5812 5813 5814 5815 5816 5817 582 5821 5822 5829 583 5831 5832 5839 59 591 5911 5912 5913 5914 5919 592 5921 5922 593 5931 5932 5933 597 5972 5973 5977 598 5981 5983 5984 5985 5986 5988 5989 599 5991 5992 5993 6 61 611 6112 6114 6115 6116 6117 6118 612 6122 6129 613 6131 6132 6133 62 621 6211 6212 6213 6214 625 6251 6252 6253 6254 6255 6259 629 6291 6292 6299 63 633 6331 6332 634 6341 6342 6343 6345 6349 635 6351 6352 6353 6354 6359 64 641 6411 6412 6413 6414 6415 6416 6417 6419 642 6421 6422 6423 6424 6429 65 651 6511 6512 6513 6514 6515 6516 6517 6518 6519 652 6521 6522 6523 6524 6525 6526 6529 653 6531 6532 6533 6534 6535 6536 6538 6539 654 6541 6542 6543 6544 6545 6546 6549 655 6551 6552 656 6561 6562 6563 6564 6565 657 6571 6572 6573 6574 6575 6576 6577 6578 6579 658 6581 6582 6583 6584 6585 6589 659 6591 6592 6593 6594 6595 6596 66 661 6611 6612 6613 6618 662 6623 6624 663 6631 6632 6633 6635 6637 6638 6639 664 6641 6643 6644 6645 6647 6648 6649 665 6651 6652 6659 666 6661 6662 667 6671 6672 6673 6674 67 671 6712 6713 6714 6715 672 6724 6726 6727 6728 673 6732 6734 6735 674 6741 6742 6743 6744 6745 675 6752 6753 6754 6755 6756 6757 676 6761 6762 6763 6764 6768 677 6770 678 6781 6782 679 6791 6793 6794 6795 68 681 6811 6812 682 6821 6823 6824 6825 6826 6827 683 6831 6832 684 6841 6842 685 6851 6852 686 6861 6863 687 6871 6872 689 6891 6898 6899 69 691 6911 6912 692 6921 6924 693 6931 6932 6935 694 6941 6942 6943 6944 695 6951 6952 6953 6954 6955 6956 6957 696 6963 6964 6965 6966 6968 697 6973 6974 6975 6978 699 6991 6992 6993 6994 6995 6996 6997 6998 6999 7 71 711 7111 7112 7119 712 7121 7128 713 7131 7132 7133 7138 7139 714 7144 7148 7149 716 7161 7162 7163 7164 7165 7169 718 7181 7187 7189 72 721 7211 7212 7213 7219 722 7223 7224 723 7231 7232 7233 7234 7239 724 7243 7244 7245 7246 7247 7248 7249 725 7251 7252 7259 726 7263 7265 7266 7268 7269 727 7271 7272 728 7281 7282 7283 7284 7285 73 731 7311 7312 7313 7314 7315 7316 7317 733 7331 7339 735 7351 7359 737 7371 7372 7373 7374 74 741 7412 7413 7414 7415 7417 7418 7419 742 7421 7422 7423 7424 7425 7426 7427 7429 743 7431 7434 7435 7436 7438 7439 744 7441 7442 7443 7444 7447 7448 7449 745 7451 7452 7453 7456 7459 746 7461 7462 7463 7464 7465 7468 7469 747 7471 7472 7473 7474 7478 7479 748 7481 7482 7483 7484 7485 7486 7489 749 7491 7492 7499 75 751 7511 7512 7519 752 7522 7523 7526 7527 7528 7529 759 7598 7599 76 761 7613 7614 7615 7616 762 7621 7622 7628 763 7633 7638 764 7641 7642 7643 7648 7649 77 771 7711 7712 772 7722 7723 7724 7725 7726 7728 773 7731 7732 774 7741 7742 775 7751 7752 7753 7754 7755 7757 7758 776 7761 7762 7763 7764 7768 778 7781 7782 7783 7784 7786 7787 7788 78 781 7811 7812 782 7821 7822 783 7831 784 7841 7842 7843 785 7851 7852 7853 786 7861 7862 7863 7868 79 791 7916 7917 7918 7919 792 7921 7928 7929 793 7931 7932 7939 8 81 811 812 8121 8122 813 8131 8132 8138 8139 82 821 8211 8212 8213 8215 8217 8218 83 831 8311 8312 8313 8319 84 841 8411 8412 8413 8414 8415 8416 842 8421 8422 8423 8424 8425 8426 8427 8428 843 8431 8432 8437 8438 844 8441 8442 8447 8448 845 8451 8452 8453 8454 8455 8456 8458 8459 846 8461 8462 8469 848 8481 8482 8483 8484 85 851 8511 8512 8513 8514 8515 8517 8519 87 871 8711 8713 8714 8719 872 8721 8722 8723 8724 873 8731 8732 874 8741 8742 8743 8744 8745 8746 8747 8749 88 881 8811 8812 8813 882 8821 8822 8823 8824 8825 8826 883 8831 8839 884 8841 8842 8843 885 8853 8854 8855 8857 8859 89 891 8911 8912 8913 8919 892 8921 8922 8924 8928 893 8931 8932 8933 8939 894 8941 8942 8943 8944 8946 8947 895 8951 8952 8959 896 8961 8962 8963 8964 8965 8966 897 8972 8973 8974 898 8981 8982 8984 8989 899 8991 8992 8993 8994 8996 8997 8998 8999 9 93 931 96 961 97 971 9710 972 99 998]>
  importAssoc: {}

for itm in ig.existing.export
  ig.existing.exportAssoc[itm] = true
for itm in ig.existing.import
  ig.existing.importAssoc[itm] = true
utils.offset = (element, side) ->
  top = 0
  left = 0
  do
    top += element.offsetTop
    left += element.offsetLeft
  while element = element.offsetParent
  {top, left}


utils.deminifyData = (minified) ->
  out = for row in minified.data
    row_out = {}
    for column, index in minified.columns
      row_out[column] = row[index]
    for column, indices of minified.indices
      row_out[column] = indices[row_out[column]]
    row_out
  out


utils.formatNumber = (input, decimalPoints = 0) ->
  input = parseFloat input
  if decimalPoints
    wholePart = Math.floor input
    decimalPart = input % 1
    wholePart = insertThousandSeparator wholePart
    decimalPart = Math.round decimalPart * Math.pow 10, decimalPoints
    decimalPart = decimalPart.toString()
    while decimalPart.length < decimalPoints
      decimalPart = "0" + decimalPart
    "#{wholePart},#{decimalPart}"
  else
    wholePart = Math.round input
    insertThousandSeparator wholePart


insertThousandSeparator = (input, separator = ' ') ->
    price = Math.round(input).toString()
    out = []
    len = price.length
    for i in [0 til len]
      out.unshift price[len - i - 1]
      isLast = i is len - 1
      isThirdNumeral = 2 is i % 3
      if isThirdNumeral and not isLast
        out.unshift separator
    out.join ''

utils.backbutton = (parent) ->
  parent.append \a
    ..attr \class \backbutton
    ..html '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" baseProfile="full" width="76" height="76" viewBox="0 0 76.00 76.00" enable-background="new 0 0 76.00 76.00" xml:space="preserve"><path fill="#000000" fill-opacity="1" stroke-width="0.2" stroke-linejoin="round" d="M 57,42L 57,34L 32.25,34L 42.25,24L 31.75,24L 17.75,38L 31.75,52L 42.25,52L 32.25,42L 57,42 Z "/></svg>'
